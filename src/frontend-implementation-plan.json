{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Enforce authentication requirement and redirect unauthenticated users to login page",
  "requirements": [
    {
      "id": "REQ-43",
      "summary": "Update the App.tsx router configuration to enforce authentication checks on all protected routes (dashboard, inventory, products, billing, subscriptions, reports, customers). Unauthenticated users must be redirected to the login page (/login) before accessing any protected page.",
      "acceptanceCriteria": [
        "When an unauthenticated user navigates to the root URL (/), they are redirected to /login",
        "When an unauthenticated user attempts to access any protected route (e.g., /dashboard, /inventory, /products), they are redirected to /login",
        "After successful Internet Identity authentication, the user is redirected to /dashboard",
        "Authenticated users can access all protected routes without being redirected to login"
      ],
      "file_operations": [
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Add authentication guard logic to router configuration using the useInternetIdentity hook. Implement beforeLoad hooks on all protected routes (dashboard, inventory, products, billing, subscriptions, reports, customers) to check isAuthenticated state and redirect unauthenticated users to /login. Add a root route (/) that redirects to /dashboard for authenticated users or /login for unauthenticated users. Ensure /login route remains publicly accessible without authentication checks."
        }
      ]
    },
    {
      "id": "REQ-44",
      "summary": "Update the Layout component to check authentication state and redirect unauthenticated users to the login page if they attempt to access protected routes through direct navigation or URL entry.",
      "acceptanceCriteria": [
        "Layout component checks isAuthenticated state from useInternetIdentity hook",
        "If user is not authenticated and attempts to render a protected page, redirect to /login occurs",
        "Redirect logic works consistently across all protected routes"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/Layout.tsx",
          "operation": "modify",
          "description": "Add authentication state check using the useInternetIdentity hook at the beginning of the Layout component. If isAuthenticated is false, immediately navigate to /login using the router's navigate function or window.location. This provides a second layer of protection in addition to the route-level guards in App.tsx. Ensure the redirect logic executes before rendering any protected content."
        }
      ]
    },
    {
      "id": "REQ-45",
      "summary": "Document the admin Internet Identity credentials in the project documentation or provide them in a secure manner to the user for accessing the application.",
      "acceptanceCriteria": [
        "Admin Internet Identity principal or authentication instructions are documented",
        "User receives clear instructions on how to authenticate using Internet Identity",
        "Documentation includes steps for creating an Internet Identity if the user doesn't have one"
      ],
      "file_operations": [
        {
          "path": "frontend/README.md",
          "operation": "create",
          "description": "Create a comprehensive README documenting the Internet Identity authentication flow. Include instructions on how to access the application, steps to create a new Internet Identity at https://identity.ic0.app, and how to use it to log in to the Salad Khatora application. Explain that Internet Identity uses biometric or security key authentication and does not require traditional username/password credentials. Add a section on accessing the login page at /login and what to expect after successful authentication (redirect to /dashboard). Note that there is no pre-configured admin account; each user creates their own Internet Identity."
        }
      ]
    }
  ]
}